# LightModelling

Визуализатор 3D моделей с системой освещения и трассировкой лучей.


## Возможности

### Просмотр моделей
- ✅ Загрузка STL файлов
- ✅ Иерархическое дерево модели для выбора отдельных частей
- ✅ Выделение выбранных частей модели
- ✅ Управление позицией и вращением модели и её частей через gizmos

### Система освещения
- ✅ **Directional Light** (Направленный свет) - бесконечно удаленный источник света с настраиваемым направлением
- ✅ **Point Light** (Точечный свет) - источник света, испускающий лучи во всех направлениях
- ✅ **Spot Light** (Прожектор) - конусообразный источник света с настраиваемым углом

### Визуализация лучей
- ✅ Генерация и визуализация световых лучей от источников
- ✅ Отражение лучей от поверхностей моделей
- ✅ Настройка количества и длины лучей
- ✅ Цветовая индикация разных источников света

### Управление
- ✅ **Gizmos** для перемещения и вращения объектов:
  - Стрелки (X, Y, Z) для перемещения по осям
  - Кольца для вращения вокруг осей
- ✅ Blender-подобное управление камерой:
  - ЛКМ + перетаскивание - вращение камеры
  - СКМ + перетаскивание - перемещение камеры
  - Колесико мыши - масштаб (адаптивный)
  - WASD - движение камеры (адаптивное)
  - Q/E - вверх/вниз
- ✅ ViewCube для быстрой ориентации камеры

### Настройки источников света
- ✅ Позиция (X, Y, Z)
- ✅ Цвет и интенсивность
- ✅ Направление (для Directional и Spot)
- ✅ Угол конуса (для Spot)
- ✅ Количество и длина визуализируемых лучей

## Требования

- Windows 10 или выше
- .NET 10.0 Runtime
- Visual Studio 2022 или выше (для разработки)

## Установка

1. Клонируйте репозиторий:
```bash
git clone https://github.com/yurchik228336/LightModelling.git
cd LightModelling
```

2. Откройте проект в Visual Studio:
   - Откройте файл `LightAddonApp/LightAddonApp.csproj`
   - Восстановите NuGet пакеты
   - Соберите проект (F6)

3. Запустите приложение:
   - Нажмите F5 или запустите `LightAddonApp.exe` из папки `bin/Debug/net10.0-windows/`

## Использование

### Загрузка модели

1. Нажмите кнопку **"Открыть STL"** в верхней панели
2. Выберите STL файл
3. Модель будет загружена и отображена в 3D сцене

### Управление моделью

- **Выбор модели**: Кликните по модели в 3D сцене или выберите её в дереве моделей слева
- **Перемещение**: Используйте gizmo-стрелки (X - красная, Y - зелёная, Z - синяя)
- **Вращение**: Используйте gizmo-кольца для вращения вокруг осей
- **Выбор части модели**: Кликните по части в дереве моделей для выбора отдельной грани

### Добавление источников света

1. Нажмите кнопку **"Добавить источник света"**
2. Выберите тип источника:
   - **Directional** - направленный свет (как солнце)
   - **Point** - точечный свет (как лампочка)
   - **Spot** - прожектор (как фонарик)
3. Источник света появится в сцене и в списке источников слева

### Настройка источников света

1. Выберите источник света из списка или кликните по его визуализации в сцене
2. В правой панели настройте параметры:
   - **Позиция** - переместите с помощью gizmos или введите значения вручную
   - **Интенсивность** - яркость света (0-2)
   - **Количество лучей** - сколько лучей визуализировать (1-1000)
   - **Длина лучей** - максимальная длина лучей (1-1000)
   - **Направление** - для Directional света (выпадающий список)
3. Для вращения источника света используйте gizmo-кольца

### Визуализация лучей

1. Нажмите кнопку **"Лучи: Вкл"** для включения визуализации лучей
2. Убедитесь, что у выбранного источника света включен чекбокс **"Показать лучи"**
3. Лучи будут визуализированы с отражениями от поверхностей моделей

### Управление камерой

- **Вращение**: Зажмите ЛКМ и перемещайте мышь
- **Перемещение**: Зажмите СКМ и перемещайте мышь
- **Приближение/отдаление**: Крутите колесико мыши
- **Движение**: Используйте клавиши WASD
- **Вверх/вниз**: Используйте клавиши Q/E
- **Быстрая ориентация**: Кликните по граням ViewCube в правом нижнем углу

## Технические детали

### Используемые технологии

- **WPF** - пользовательский интерфейс
- **HelixToolkit.Wpf** - 3D визуализация и управление камерой
- **.NET 10.0** - платформа

### Основные компоненты

- `MainWindow.xaml.cs` - основной код приложения, обработка событий, логика 3D сцены
- `LightSource` - класс для управления источниками света
- Система gizmos для интерактивного управления объектами
- Алгоритм Moller-Trumbore для пересечения лучей с треугольниками
- Формула Родрига для вращения векторов направления света

## Версия

**V 0.0.1** - Первая версия с базовым функционалом:
- Просмотр STL моделей
- Система освещения (3 типа источников)
- Визуализация лучей с отражениями
- Gizmos для управления объектами
- Blender-подобное управление камерой


